import sqlite3 sql
import os

db = sql.connect(os.environ['TWORK_DB'])
cur = db.cursor()

def lstasks(target):
    list = []
    cur.execute('select * from DAILYTERMINATED')
    tasks = sorted(cur.fetchall(), key=lambda session:session[1])
    if (target):
        tasks = [row for row in tasks if row[1] in target]
    return tasks

def getTaskVec(task, i, j):
    vec = []
    cur.execute('select * from '+task+' where ROWID > '+i+' and ROWID < '+j)
    sessions = cur.fetchall()
    if sessions[0][1] > 0:
        for row in session:
            vec.append(row[1])
    else:
        for i in len(session):
            if i < len(session)-1:
                vec.append(session[i+1][0]-session[i][0])
    return vec
    
def getVects(target):
    vect = []
    vecount = -1;
    tasks = lstasks(target)
    curtask = tasks[0][1]
    
    for i in len(tasks):
        if curtask != tasks[i][1]:
            if tasks[i][1] == tasks[i+1][1]:
                vect.append([tasks[i][1]])
                vecount++
            else:
                continue
        if tasks[i][1] == tasks[i+1][1]:
            vect[vecount].append(getTaskVec(tasks[i][1], tasks[i][2], tasks[i+1][2]))
    return vect


db.commit()
db.close()
